var JSCapture=JSCapture||function(){"use strict";function e(e){n(e),a(function(){"function"==typeof e.done&&(e.captureStarted(),setTimeout(function(){t(e),e.done(y.toDataURL())},e.delay))},e)}function t(e){var t=y.getContext("2d");y.width=e.width*e.scale,y.height=e.height*e.scale,e.process.forEach(function(e){e(t,y)}),1!==e.scale?t.drawImage(p,-e.x*e.scale,-e.y*e.scale,f*e.scale,l*e.scale):t.drawImage(p,-e.x,-e.y)}function n(e){var t=Object.keys(v);return t.forEach(function(t){e[t]=e[t]||v[t]}),e}function a(e,t){h?e(m):navigator.getUserMedia({video:{mandatory:{chromeMediaSource:"screen",maxWidth:f,maxHeight:l,minWidth:f,minHeight:l}}},function(n){m=n,h=!0,y=i("canvas",t),p=i("video",t),p.src=URL.createObjectURL(n),p.oncanplay=function(){e(n)}},t.fail)}function i(e,t){var n=g[e]||document.createElement(e);return document.body.appendChild(n),n.width=f*t.scale,n.height=l*t.scale,n.style.position="absolute",n.style.top=-l*t.scale+"px",n.style.left=-f*t.scale+"px","video"===e&&n.setAttribute("autoplay",!0),n}function o(e){if(n(e),"undefined"==typeof Whammy)throw new Error("Whammy is required as dependency for screen recording");a(function(){d=new Whammy.Video(e.frameRate),s=!0,e.captureStarted(),setTimeout(function(){r(0,1/e.frameRate*1e3,e)},e.delay)},e)}function r(e,n,a){return e>=a.duration?c(a.done):(t(a),setTimeout(function(){d.add(y)},0),void setTimeout(function(){r(e+n,n,a)},n))}function c(e){if(s){var t=d.compile();s=!1,"function"==typeof e&&e(t)}}function u(){return s}var d,s=!1,f=screen.availWidth,l=screen.availHeight,h=!1,m=null,p=null,y=null,g={},v={delay:0,x:0,y:0,width:f,height:l,scale:1,done:function(){},process:[],duration:1/0,frameRate:32,fail:function(){},captureStarted:function(){}};return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia,{capture:e,record:o,stopRecording:c,isRecording:u}}();